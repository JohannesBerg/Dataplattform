openapi: 3.0.0
info:
  description: >
    Dette er APIene til Knowit dataplattform

    [https://github.com/knowit/Dataplattform](https://github.com/knowit/Dataplattform)
    
    
    Dette er for å hente ut raw data fra DynamoDB. Om du vil ha strukturert data så er det beste å hente ut direkte fra MySQL-instansen.
  version: "1.0.0-oas3"
  title: Knowit dataplattform
tags:
  - name: docs
    description: Fetch alle dokumenter for en type. Under så er det flere forskjellige typer, men husk at om du lager din egen type så er det bare å skrive get_docs/{type}, det er ikke bare de under som funker.  
      Svaret fra alle disse requestene er en url som du igjen må requeste. Dette kan virke litt teit, men det er slik man må gjøre for å komme seg over 6MB grensen AWS Lambda payloads har.  
      
      
      Pass på om du henter ut data for all tid så kan det gå veldig treigt, eventuelt timeout.
      
      
      P.S! Du må være authorized for å kjøre disse (trykk på hengelåsen over).
paths:
  '/get_docs/{type}':
    get:
      tags:
        - docs
      summary: Henter rå data ved hjelp av type (og timestamps om du vil)
      description: Dette er et generelt eksempel.
      operationId: get_docs
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
        - name: type
          in: path
          description: Hva slags datatype du vil hente ut. Eksempel, GithubType, SlackType, EventRatingType, EventType, UBWType.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RawResponse'
            
        '400':
          description: Invalid status value
          
  '/get_docs/GithubType':
    get:
      tags:
        - docs
      summary: Henter rå data fra Github
      description: Alle data som er her nå er fra github.com/knowit.
      operationId: get_docs-GithubType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GithubTypeResponse'
  '/get_docs/UBWType':
    get:
      tags:
        - docs
      summary: Henter rå data fra UBW
      description: Dette er aggregerte antall fagtimer per uke i knowit objectnet.
      operationId: get_docs-UBWType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UBWTypeResponse'
  '/get_docs/SlackType':
    get:
      tags:
        - docs
      summary: Henter rå data fra Slack
      description: Dette er hvilken kanal folk snakker i og tilhørende timestamp.
      operationId: get_docs-SlackType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SlackTypeResponse'
  '/get_docs/EventType':
    get:
      tags:
        - docs
      summary: Henter rå data fra et fagarrangement.
      description: Det er ett datapunkt per fagarrangement som sier hvor mange som kom på arrangementet og hvilken faggruppe som sto bak det.
      operationId: get_docs-EventType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EventTypeResponse'
  '/get_docs/EventRatingType':
    get:
      tags:
        - docs
      summary: Henter rå data fra en vurdering av fagarrangement.
      description: Det er ett datapunkt per stemme på et fagarrangement.
      operationId: get_docs-EventRatingType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EventRatingTypeResponse'
  '/get_docs/DayRatingType':
    get:
      tags:
        - docs
      summary: Henter rå data fra en vurdering av dagen. Dette er boksen som står på kontoret.
      description: Det er ett datapunkt per stemme.
      operationId: get_docs-DayRatingType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DayRatingTypeResponse'
  '/get_docs/SlackReactionType':
    get:
      tags:
        - docs
      summary: Henter rå data fra Slack reactions.
      description: Hvilken reaction (emoji) noen har brukt i slack.
      operationId: get_docs-SlackReactionType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SlackReactionTypeResponse'
  '/get_docs/KnowitlabsType':
    get:
      tags:
        - docs
      summary: Henter blogginnleggdata på Knowitlabs.no
      description: tittel, undertittel, forfatter og dato. Ikke selve blogginnlegget.
      operationId: get_docs-KnowitlabsType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KnowitlabsTypeResponse'
  '/get_docs/YrType':
    get:
      tags:
        - docs
      summary: Temperatur, nedbør etc data fra yr.no
      description: Alle dataene er fra Lakkegata, Oslo.
      operationId: get_docs-YrType
      parameters:
        - name: timestamp_from
          in: query
          description: Timestamp fra når du vil hente ut docsene.
          required: false
          schema:
            type: integer
            format: int32
        - name: timestamp_to
          in: query
          description: Timestamp til.
          required: false
          schema:
            type: integer
            format: int32
        - name: just_url
          in: query
          description: Sett denne til true om du vil bare få tak i URLen og ikke de 25 nyeste datapunktene.
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/YrTypeResponse'
servers:
  - url: "https://mt9ktgfjcl.execute-api.eu-central-1.amazonaws.com/prod/"
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: x-api-key
      in: header
  schemas:
    RawResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/GithubTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    GithubTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: GithubType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          description: Se her for mer informasjon https://developer.github.com/webhooks/#example-delivery
          properties:
            ref:
              type: string
              example: refs/heads/feat/machine_learning
            repository:
              type: object
              description: Dette er hva repository sitt fulle navn er.
              properties:
                full_name: 
                  type: string
                  example: knowit/Dataplattform
            sender:
              type: object
              properties:
                login: 
                  type: string
                  example: Tinusf
    GithubTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/GithubTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
          
    UBWTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: UBWType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          description: Aggregert fagtimer per uke fra UBW.
          properties:
            _recno:
              type: string
              example: 0
            _section:
              type: string
              example: D
            tab:
              type: string
              example: A
              description: A om den er ferdig, B om det holder på å validere alle timene.
            reg_period:
              type: string
              example: 201931
              description: 201931 er år 2019, uke 31.
            used_hrs:
              type: string
              example: 16
              description: Hvor mange timer som ble brukt i denne uken til fagtimer.
    UBWTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/UBWTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    SlackTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: SlackType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          description: En slackmelding ble sendt.
          properties:
            event:
              type: object
              properties:
                type: 
                  type: string
                  example: message
                  description: hva slags type slack event var dette. her vil det alltid være en message.
                channel:
                  type: string
                  example: Cxxxxxxxxx
                  description: Slack kanal ID.
                  
            event_time:
              type: integer
              description: Når denne meldingen var.
              example: 1564574281
            team_id:
              type: string
              description: ID til et slack team. Forskjellig fra hvert workspace.
              example: Txxxxxxxxx

    SlackTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/SlackTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    EventTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: EventType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          properties:
            event_id:
              type: string
              description: En id som er lik ID'en google calendar lager.
              example: 0861axxxxxxxxxxxx
            event_name:
              type: string
              description: Hva dette arrangementet heter på google calendar
              example: Rust-kveld
            event_start:
              type: string
              example: "2019-07-16T16:00:00+02:00"
            event_end:
              type: string
              example: "2019-07-16T20:30:00+02:00"
            number_of_people:
              type: integer
              example: 25
              description: Hvor mange var på arrangementet. 
    EventTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/EventTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    EventRatingTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: EventRatingType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          properties:
            button:
              type: integer
              description: Hva denne stemmer var. 1 er grønn knapp, 0 er gul knapp, -1 er rød knapp.
              example: 1
            event_code:
              type: string
              description: En kombinasjon av 0'ere og 1'ere som gir en unik (for dette tidspunktet) kode som kan kobles sammen med den fysiske vurderingsknappen.
              example: "001111"
    EventRatingTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/EventRatingTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    DayRatingTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: DayRatingType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          properties:
            button:
              type: integer
              description: Hva denne stemmer var. 1 er tommel opp, -1 er tommel ned.
              example: 1
            
    DayRatingTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/DayRatingTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    SlackReactionTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: SlackReactionType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          properties:
            event:
              type: object
              properties:
                type: 
                  type: string
                  example: reaction_added
                  description: hva slags type slack event var dette. her vil det alltid være en reaction_added.
                item:
                  type: object
                  properties:
                    channel:
                      example: Cxxxxxxxxx
                      description: Slack kanal ID.
                  
            event_time:
              type: integer
              description: Når denne slack reactionen var.
              example: 1564574281
            team_id:
              type: string
              description: ID til et slack team. Forskjellig fra hvert workspace.
              example: Txxxxxxxxx
            
    SlackReactionTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/SlackReactionTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    KnowitlabsTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: KnowitlabsType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          description: En slackmelding ble sendt.
          properties:
            id:
              type: string
              description: Denne blogposten sin ID. (fra Knowitlabs.no)
              example: 7d939aac80a4
            title:
              type: string
              description: Bloggtittel
              example: Sommerjobb hos Knowit
            subtitle:
              type: string
              description: Bloggposten sin undertittel
            created:
              type: integer
              description: timestmap
              example: 1564406794
            author:
              type: string
              description: Forfatter
              example: Tinus Flagstad
    KnowitlabsTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/KnowitlabsTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
    YrTypeDoc:
      type: object
      required:
        - id
        - type
        - timestamp
        - data
      properties:
        id:
          type: string
          example: AAWO9V1atJ3yL1A+uxDD/Q==
        type:
          type: string
          example: YrType
        timestamp:
          type: integer
          example: 1562055759
        data:
          type: object
          description: En slackmelding ble sendt.
          properties:
            id:
              type: string
              description: Denne blogposten sin ID. (fra Yr.no)
              example: 7d939aac80a4
            title:
              type: string
              description: Bloggtittel
              example: Sommerjobb hos Knowit
            subtitle:
              type: string
              description: Bloggposten sin undertittel
            created:
              type: integer
              description: timestmap
              example: 1564406794
            author:
              type: string
              description: Forfatter
              example: Tinus Flagstad
    YrTypeResponse:
      type: object
      required:
        - most_recent_25_docs
        - all_docs_url
      properties:
        most_recent_25_docs:
          type: array
          items:
            $ref: '#/components/schemas/YrTypeDoc'
          description: Her ligger en liste med de 25 nyligste datapunktene for denne typen.
        all_docs_url:
          type: string
          example: https://dataplattform-get-docs-cache.s3.amazonaws.com/xxxxxxxxxx..
          description: En url som blir signert og funker i bare 5 minutter men som gir deg all dataen. Dette kan bli brukt fordi most_recent_25_docs returnerer maks 25 datapunkter, det hender man vil ha flere enn det.
security:
  - api_key: []